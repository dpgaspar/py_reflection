<!DOCTYPE html>
<meta charset="utf-8">
<style>

.node circle {
  fill: #fff;
  stroke: steelblue;
  stroke-width: 1.5px;
}

.node {
  font: 10px sans-serif;
}

.link {
  fill: none;
  stroke: #ccc;
  stroke-width: 2.5px;
}

</style>
<body></body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script>

var treeData = {'name': 'ROOT', 'children': [{'name': 'object', 'children': [{'name': '_PackageBoundObject', 'children': [{'name': 'Blueprint'}]}, {'name': 'BaseForm', 'children': [{'name': 'NewBase', 'children': [{'name': 'Form', 'children': [{'name': 'DynamicForm', 'children': [{'name': 'ResetPasswordForm'}, {'name': 'LoginForm_db'}, {'name': 'LoginForm_oid'}]}, {'name': 'SecureForm', 'children': [{'name': 'SessionSecureForm', 'children': [{'name': 'Form'}]}]}]}]}]}, {'name': 'DatePickerWidget'}, {'name': 'SecurityManager'}, {'name': 'Babel'}, {'name': 'Field', 'children': [{'name': 'DateTimeField', 'children': [{'name': 'DateField'}]}, {'name': 'SelectFieldBase', 'children': [{'name': 'QuerySelectField', 'children': [{'name': 'QuerySelectMultipleField'}]}, {'name': 'SelectField'}]}, {'name': 'StringField', 'children': [{'name': 'TextField', 'children': [{'name': 'FileUploadField'}, {'name': 'ImageUploadField'}, {'name': 'HiddenField'}, {'name': 'PasswordField'}, {'name': 'TextAreaField'}]}]}, {'name': 'BooleanField'}, {'name': 'IntegerField'}]}, {'name': 'Input', 'children': [{'name': 'PasswordInput', 'children': [{'name': 'BS3PasswordFieldWidget'}]}, {'name': 'TextInput', 'children': [{'name': 'BS3TextFieldWidget'}]}]}, {'name': 'Immutable', 'children': [{'name': 'TableClause', 'children': [{'name': 'Table'}]}, {'name': 'ColumnClause', 'children': [{'name': 'Column'}]}]}, {'name': 'SchemaEventTarget', 'children': [{'name': 'SchemaType', 'children': [{'name': 'Boolean'}]}, {'name': 'SchemaItem', 'children': [{'name': 'Column'}, {'name': 'Table'}, {'name': 'ForeignKey'}, {'name': 'MetaData'}]}]}, {'name': 'ActionItem'}, {'name': 'basestring', 'children': [{'name': 'unicode', 'children': [{'name': 'HTMLString'}]}]}, {'name': 'BaseApp'}, {'name': 'BabelManager'}, {'name': 'TextArea', 'children': [{'name': 'BS3TextAreaFieldWidget'}]}, {'name': 'BaseFilter', 'children': [{'name': 'FilterStartsWith'}, {'name': 'FilterSmaller'}, {'name': 'FilterRelation', 'children': [{'name': 'FilterRelationOneToManyEqual'}, {'name': 'FilterRelationOneToManyNotEqual'}, {'name': 'FilterRelationManyToManyEqual'}]}, {'name': 'FilterNotEqual'}, {'name': 'FilterEndsWith'}, {'name': 'FilterContains'}, {'name': 'FilterEqualFunction'}, {'name': 'FilterNotEndsWith'}, {'name': 'FilterNotContains'}, {'name': 'FilterNotStartsWith'}, {'name': 'FilterEqual'}, {'name': 'FilterGreater'}]}, {'name': 'FileStorage'}, {'name': 'SessionWrapper'}, {'name': 'BS3ImageUploadFieldWidget'}, {'name': 'Base', 'children': [{'name': 'PermissionView'}, {'name': 'ViewMenu'}, {'name': 'Role'}, {'name': 'User'}, {'name': 'Permission'}]}, {'name': 'Menu'}, {'name': 'TemplateFilters'}, {'name': 'Unique'}, {'name': 'LoginManager'}, {'name': 'Concatenable', 'children': [{'name': 'String'}]}, {'name': 'RenderTemplateWidget', 'children': [{'name': 'ShowWidget'}, {'name': 'FormWidget', 'children': [{'name': 'SearchWidget'}]}, {'name': 'ListWidget', 'children': [{'name': 'ListThumbnail'}, {'name': 'ListCarousel'}, {'name': 'ListBlock'}, {'name': 'ListItem'}]}, {'name': 'ChartWidget'}]}, {'name': 'DataRequired', 'children': [{'name': 'Required'}]}, {'name': 'DateTimePickerWidget'}, {'name': 'EqualTo'}, {'name': 'Extension', 'children': [{'name': 'SRegRequest'}, {'name': 'SRegResponse'}]}, {'name': 'Length'}, {'name': 'BS3FileUploadFieldWidget'}, {'name': 'OpenIDResponse'}, {'name': 'Consumer'}, {'name': 'BaseView', 'children': [{'name': 'SimpleFormView', 'children': [{'name': 'ResetMyPasswordView'}, {'name': 'ResetPasswordView'}]}, {'name': 'LocaleView'}, {'name': 'BaseModelView', 'children': [{'name': 'BaseCRUDView', 'children': [{'name': 'GeneralView', 'children': [{'name': 'PermissionViewGeneralView'}, {'name': 'UserGeneralView', 'children': [{'name': 'UserDBGeneralView'}, {'name': 'UserOIDGeneralView'}]}, {'name': 'RoleGeneralView'}, {'name': 'PermissionGeneralView'}, {'name': 'ViewMenuGeneralView'}]}]}, {'name': 'BaseChartView', 'children': [{'name': 'ChartView'}, {'name': 'TimeChartView'}]}]}, {'name': 'AuthView', 'children': [{'name': 'AuthDBView'}, {'name': 'AuthOIDView'}]}, {'name': 'IndexView'}]}, {'name': 'OpenID'}, {'name': '_MappedAttribute', 'children': [{'name': 'declared_attr'}]}, {'name': 'property', 'children': [{'name': 'declared_attr'}]}, {'name': '_DateAffinity', 'children': [{'name': 'Integer'}, {'name': 'DateTime'}]}, {'name': 'Operators', 'children': [{'name': 'ColumnOperators', 'children': [{'name': 'ColumnElement', 'children': [{'name': 'ColumnClause', 'children': [{'name': 'Column'}]}]}]}]}, {'name': 'FileManager', 'children': [{'name': 'ImageManager'}]}, {'name': 'GeneralModelConverter'}, {'name': 'Visitable', 'children': [{'name': 'ClauseElement', 'children': [{'name': 'Selectable', 'children': [{'name': 'FromClause', 'children': [{'name': 'TableClause', 'children': [{'name': 'Table'}]}]}]}, {'name': 'ColumnElement', 'children': [{'name': 'ColumnClause', 'children': [{'name': 'Column'}]}]}]}, {'name': 'TypeEngine', 'children': [{'name': 'Integer'}, {'name': 'TypeDecorator', 'children': [{'name': 'ImageColumn'}, {'name': 'FileColumn'}]}, {'name': 'Boolean'}, {'name': 'String'}, {'name': 'DateTime'}]}, {'name': 'SchemaItem', 'children': [{'name': 'Column'}, {'name': 'Table'}, {'name': 'ForeignKey'}, {'name': 'MetaData'}]}]}, {'name': 'Filters'}, {'name': 'MenuItem'}, {'name': 'Inspector'}, {'name': 'BaseMixin', 'children': [{'name': 'AuditMixin'}]}, {'name': 'groupby'}, {'name': 'Select', 'children': [{'name': 'Select2ManyWidget'}, {'name': 'Select2Widget'}]}, {'name': 'BaseException', 'children': [{'name': 'Exception', 'children': [{'name': 'SQLAlchemyError', 'children': [{'name': 'StatementError', 'children': [{'name': 'DBAPIError', 'children': [{'name': 'DatabaseError', 'children': [{'name': 'IntegrityError'}]}]}]}, {'name': 'InvalidRequestError', 'children': [{'name': 'NoResultFound'}]}]}, {'name': 'StandardError', 'children': [{'name': 'ValueError', 'children': [{'name': 'ValidationError'}]}]}]}]}]}, {'name': 'DataModel', 'children': [{'name': 'SQLAModel'}]}]}

var m = [20, 120, 20, 120],
    w = 1280 - m[1] - m[3],
    h = 800 - m[0] - m[2],
    i = 0,
    root;

var tree = d3.layout.tree()
    .size([h, w]);
    
    
var diagonal = d3.svg.diagonal()
    .projection(function(d) { return [d.y, d.x]; });

var vis = d3.select("#body").append("svg:svg")
    .attr("width", w + m[1] + m[3])
    .attr("height", h + m[0] + m[2])
  .append("svg:g")
    .attr("transform", "translate(" + m[3] + "," + m[0] + ")");

  var nodes = tree.nodes(treeData),
      links = tree.links(nodes);

  
  // Initialize the display to show a few nodes.
  update(root); 

function update(source) {
  var duration = d3.event && d3.event.altKey ? 5000 : 500;

  // Compute the new tree layout.
  var nodes = tree.nodes(root).reverse();

  // Normalize for fixed-depth.
  nodes.forEach(function(d) { d.y = d.depth * 180; });

  // Update the nodes…
  var node = vis.selectAll("g.node")
      .data(nodes, function(d) { return d.id || (d.id = ++i); });

  // Enter any new nodes at the parent's previous position.
  var nodeEnter = node.enter().append("svg:g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
      .on("click", function(d) { toggle(d); update(d); });

  nodeEnter.append("svg:circle")
      .attr("r", 1e-6)
      .style("fill", function(d) { return d._children ? "lightsteelblue" : "#fff"; });

  nodeEnter.append("svg:text")
      .attr("x", function(d) { return d.children || d._children ? -10 : 10; })
      .attr("dy", ".35em")
      .attr("text-anchor", function(d) { return d.children || d._children ? "end" : "start"; })
      .text(function(d) { return d.name; })
      .style("fill-opacity", 1e-6);

  // Transition nodes to their new position.
  var nodeUpdate = node.transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });

  nodeUpdate.select("circle")
      .attr("r", 4.5)
      .style("fill", function(d) { return d._children ? "lightsteelblue" : "#fff"; });

  nodeUpdate.select("text")
      .style("fill-opacity", 1);

  // Transition exiting nodes to the parent's new position.
  var nodeExit = node.exit().transition()
      .duration(duration)
      .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
      .remove();

  nodeExit.select("circle")
      .attr("r", 1e-6);

  nodeExit.select("text")
      .style("fill-opacity", 1e-6);

  // Update the links…
  var link = vis.selectAll("path.link")
      .data(tree.links(nodes), function(d) { return d.target.id; });

  // Enter any new links at the parent's previous position.
  link.enter().insert("svg:path", "g")
      .attr("class", "link")
      .attr("d", function(d) {
        var o = {x: source.x0, y: source.y0};
        return diagonal({source: o, target: o});
      })
    .transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition links to their new position.
  link.transition()
      .duration(duration)
      .attr("d", diagonal);

  // Transition exiting nodes to the parent's new position.
  link.exit().transition()
      .duration(duration)
      .attr("d", function(d) {
        var o = {x: source.x, y: source.y};
        return diagonal({source: o, target: o});
      })
      .remove();

  // Stash the old positions for transition.
  nodes.forEach(function(d) {
    d.x0 = d.x;
    d.y0 = d.y;
  });
}

// Toggle children.
function toggle(d) {
  if (d.children) {
    d._children = d.children;
    d.children = null;
  } else {
    d.children = d._children;
    d._children = null;
  }
}

</script>
